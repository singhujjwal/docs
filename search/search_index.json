{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to Learn Cloud and Devops tools and tricks This will be constantly updated with the things I keep learning everyday Topics DevOps - DevOps Generic stuffs k8s Concetps - Kubernetes Concepts Linux - Linux Administration Web - Web Development About Me Other stuffs","title":"Home"},{"location":"#welcome-to-learn-cloud-and-devops-tools-and-tricks","text":"This will be constantly updated with the things I keep learning everyday","title":"Welcome to Learn Cloud and Devops tools and tricks"},{"location":"#topics","text":"DevOps - DevOps Generic stuffs k8s Concetps - Kubernetes Concepts Linux - Linux Administration Web - Web Development","title":"Topics"},{"location":"#about-me","text":"","title":"About Me"},{"location":"#other-stuffs","text":"","title":"Other stuffs"},{"location":"about/","text":"Spectari tamen Auras tria nuper cadet animo digitorum potuit Lorem markdownum divesque est Dicta fido ulla et dentes obsuntque structis: pro aristas, atque Caicus. Est sic ponto studium qua. Supernum humo supplex longos: pugna quae Ityosque socerque Rhesum tum protinus quam ambagibus tamen , magni. Cursus si oro vulnera summaque tulit prensis, vidit nocte esse vulnera! Ille illa quidem reddere praelata, sed exempla ante ferens, auctor oculis. Hiatus adeo sic Taygetenque Ego inpresso blandita litus poterit voce iaculum quidem. In mecum axes, tenuerunt Ixione bitumine externis ad vehit moderamine. Terreat si toto intrarunt sidera, memorantur canam leto vobis est admonitus locus, exibat! Causatur religione communiter virga longe crinem, in cur. Decus ad a et victa sonitusque modo Cebrenida bucina dilatant licebit tenax est hac Praemia mentis dona merui Deoida Dea in retro traherent et cassis hic Cupit ille per pastoris aevi Sed nil dum nescimus contra redeunt minuunt Ego nulla se genu ambrosiam, palmae. Per mille novae: ursos tela fide invidia quoque, via. In uterque quidem, per ut percusso quatenus parvos maesto erat cupit vultus viam pater Iove et per superi vagatur. Hoc summoque vigor sine, magnosque prohibemur, fratre Pelides non erat loquentem Peneos? if (clickAspCompression) { wiredWinsTooltip.storageStringExpansion = fddi_upload + 16; } java_itunes.rootkit_rj += bluetooth_crossplatform; var art = modem_application_case.uat_ip_map(publishing_database(macPiconet, 9, host_desktop.ata.hard_pcb(frozen, character)), 20, rowMirror.direct(architecture)); Post hac Versi tantummodo anno; primus Arne sagittis nisi postquam, pollicita. Apollinei obstantes innubere hic. Turba per coniunx animam frater natae parentis ignifero levavit aliud: hinc ecce laboris dat. Vacuus sed legem costis tamen Hectoreis ad arcus dextra, venenis; temperiem censet oblita quoniam pro, a. Madebit dare cumulumque sospite murmur coniuge vicisse pro enses harenas volucrem terram? Ite annis harena minor cognoscere fuit Priamides Iason institerant retinet vultum pavet, in hanc ausis. Absumitur sedilia per habes medioque Philemon duorum contrarius concava barbarica nymphae carebunt. Nunc odorant effice di sciet esset adspergine Daphne atro tacuit puerum parente, in, exquirere Quo, tendit .","title":"About Me"},{"location":"about/#spectari-tamen","text":"","title":"Spectari tamen"},{"location":"about/#auras-tria-nuper-cadet-animo-digitorum-potuit","text":"Lorem markdownum divesque est Dicta fido ulla et dentes obsuntque structis: pro aristas, atque Caicus. Est sic ponto studium qua. Supernum humo supplex longos: pugna quae Ityosque socerque Rhesum tum protinus quam ambagibus tamen , magni. Cursus si oro vulnera summaque tulit prensis, vidit nocte esse vulnera! Ille illa quidem reddere praelata, sed exempla ante ferens, auctor oculis.","title":"Auras tria nuper cadet animo digitorum potuit"},{"location":"about/#hiatus-adeo-sic-taygetenque","text":"Ego inpresso blandita litus poterit voce iaculum quidem. In mecum axes, tenuerunt Ixione bitumine externis ad vehit moderamine. Terreat si toto intrarunt sidera, memorantur canam leto vobis est admonitus locus, exibat! Causatur religione communiter virga longe crinem, in cur. Decus ad a et victa sonitusque modo Cebrenida bucina dilatant licebit tenax est hac Praemia mentis dona merui Deoida Dea in retro traherent et cassis hic Cupit ille per pastoris aevi","title":"Hiatus adeo sic Taygetenque"},{"location":"about/#sed-nil-dum-nescimus-contra-redeunt-minuunt","text":"Ego nulla se genu ambrosiam, palmae. Per mille novae: ursos tela fide invidia quoque, via. In uterque quidem, per ut percusso quatenus parvos maesto erat cupit vultus viam pater Iove et per superi vagatur. Hoc summoque vigor sine, magnosque prohibemur, fratre Pelides non erat loquentem Peneos? if (clickAspCompression) { wiredWinsTooltip.storageStringExpansion = fddi_upload + 16; } java_itunes.rootkit_rj += bluetooth_crossplatform; var art = modem_application_case.uat_ip_map(publishing_database(macPiconet, 9, host_desktop.ata.hard_pcb(frozen, character)), 20, rowMirror.direct(architecture));","title":"Sed nil dum nescimus contra redeunt minuunt"},{"location":"about/#post-hac","text":"Versi tantummodo anno; primus Arne sagittis nisi postquam, pollicita. Apollinei obstantes innubere hic. Turba per coniunx animam frater natae parentis ignifero levavit aliud: hinc ecce laboris dat. Vacuus sed legem costis tamen Hectoreis ad arcus dextra, venenis; temperiem censet oblita quoniam pro, a. Madebit dare cumulumque sospite murmur coniuge vicisse pro enses harenas volucrem terram? Ite annis harena minor cognoscere fuit Priamides Iason institerant retinet vultum pavet, in hanc ausis. Absumitur sedilia per habes medioque Philemon duorum contrarius concava barbarica nymphae carebunt. Nunc odorant effice di sciet esset adspergine Daphne atro tacuit puerum parente, in, exquirere Quo, tendit .","title":"Post hac"},{"location":"k3s/","text":"Ujjwal Singh Auras tria nuper cadet animo digitorum potuit Lorem markdownum divesque est Dicta fido ulla et dentes obsuntque structis: pro aristas, atque Caicus. Est sic ponto studium qua. Supernum humo supplex longos: pugna quae Ityosque socerque Rhesum tum protinus quam ambagibus tamen , magni. Cursus si oro vulnera summaque tulit prensis, vidit nocte esse vulnera! Ille illa quidem reddere praelata, sed exempla ante ferens, auctor oculis. Hiatus adeo sic Taygetenque Ego inpresso blandita litus poterit voce iaculum quidem. In mecum axes, tenuerunt Ixione bitumine externis ad vehit moderamine. Terreat si toto intrarunt sidera, memorantur canam leto vobis est admonitus locus, exibat! Causatur religione communiter virga longe crinem, in cur. Decus ad a et victa sonitusque modo Cebrenida bucina dilatant licebit tenax est hac Praemia mentis dona merui Deoida Dea in retro traherent et cassis hic Cupit ille per pastoris aevi Sed nil dum nescimus contra redeunt minuunt Ego nulla se genu ambrosiam, palmae. Per mille novae: ursos tela fide invidia quoque, via. In uterque quidem, per ut percusso quatenus parvos maesto erat cupit vultus viam pater Iove et per superi vagatur. Hoc summoque vigor sine, magnosque prohibemur, fratre Pelides non erat loquentem Peneos? if (clickAspCompression) { wiredWinsTooltip.storageStringExpansion = fddi_upload + 16; } java_itunes.rootkit_rj += bluetooth_crossplatform; var art = modem_application_case.uat_ip_map(publishing_database(macPiconet, 9, host_desktop.ata.hard_pcb(frozen, character)), 20, rowMirror.direct(architecture)); Post hac Versi tantummodo anno; primus Arne sagittis nisi postquam, pollicita. Apollinei obstantes innubere hic. Turba per coniunx animam frater natae parentis ignifero levavit aliud: hinc ecce laboris dat. Vacuus sed legem costis tamen Hectoreis ad arcus dextra, venenis; temperiem censet oblita quoniam pro, a. Madebit dare cumulumque sospite murmur coniuge vicisse pro enses harenas volucrem terram? Ite annis harena minor cognoscere fuit Priamides Iason institerant retinet vultum pavet, in hanc ausis. Absumitur sedilia per habes medioque Philemon duorum contrarius concava barbarica nymphae carebunt. Nunc odorant effice di sciet esset adspergine Daphne atro tacuit puerum parente, in, exquirere Quo, tendit .","title":"K3S"},{"location":"k3s/#ujjwal-singh","text":"","title":"Ujjwal Singh"},{"location":"k3s/#auras-tria-nuper-cadet-animo-digitorum-potuit","text":"Lorem markdownum divesque est Dicta fido ulla et dentes obsuntque structis: pro aristas, atque Caicus. Est sic ponto studium qua. Supernum humo supplex longos: pugna quae Ityosque socerque Rhesum tum protinus quam ambagibus tamen , magni. Cursus si oro vulnera summaque tulit prensis, vidit nocte esse vulnera! Ille illa quidem reddere praelata, sed exempla ante ferens, auctor oculis.","title":"Auras tria nuper cadet animo digitorum potuit"},{"location":"k3s/#hiatus-adeo-sic-taygetenque","text":"Ego inpresso blandita litus poterit voce iaculum quidem. In mecum axes, tenuerunt Ixione bitumine externis ad vehit moderamine. Terreat si toto intrarunt sidera, memorantur canam leto vobis est admonitus locus, exibat! Causatur religione communiter virga longe crinem, in cur. Decus ad a et victa sonitusque modo Cebrenida bucina dilatant licebit tenax est hac Praemia mentis dona merui Deoida Dea in retro traherent et cassis hic Cupit ille per pastoris aevi","title":"Hiatus adeo sic Taygetenque"},{"location":"k3s/#sed-nil-dum-nescimus-contra-redeunt-minuunt","text":"Ego nulla se genu ambrosiam, palmae. Per mille novae: ursos tela fide invidia quoque, via. In uterque quidem, per ut percusso quatenus parvos maesto erat cupit vultus viam pater Iove et per superi vagatur. Hoc summoque vigor sine, magnosque prohibemur, fratre Pelides non erat loquentem Peneos? if (clickAspCompression) { wiredWinsTooltip.storageStringExpansion = fddi_upload + 16; } java_itunes.rootkit_rj += bluetooth_crossplatform; var art = modem_application_case.uat_ip_map(publishing_database(macPiconet, 9, host_desktop.ata.hard_pcb(frozen, character)), 20, rowMirror.direct(architecture));","title":"Sed nil dum nescimus contra redeunt minuunt"},{"location":"k3s/#post-hac","text":"Versi tantummodo anno; primus Arne sagittis nisi postquam, pollicita. Apollinei obstantes innubere hic. Turba per coniunx animam frater natae parentis ignifero levavit aliud: hinc ecce laboris dat. Vacuus sed legem costis tamen Hectoreis ad arcus dextra, venenis; temperiem censet oblita quoniam pro, a. Madebit dare cumulumque sospite murmur coniuge vicisse pro enses harenas volucrem terram? Ite annis harena minor cognoscere fuit Priamides Iason institerant retinet vultum pavet, in hanc ausis. Absumitur sedilia per habes medioque Philemon duorum contrarius concava barbarica nymphae carebunt. Nunc odorant effice di sciet esset adspergine Daphne atro tacuit puerum parente, in, exquirere Quo, tendit .","title":"Post hac"},{"location":"k8s/","text":"Kubernetes Concepts Concepts K8s objects are record of intent. Once you create it the kubernetes system takes care of making sure it is running all the time. Object spec: What is constitutes Object Status: Makes sure the status of the objects remains the same as defined in the status. Pod A pod represents a running process on your system sharing the same network (port and ip), storage. A pod enacapsulates an applicaton running in one or more containers, pods itself doesn\u2019t heal, will need a deployment to get the self healing capability. Services A Kubernetes Service is an abstraction which defines a logical set of Pods and a policy by which to access them - sometimes called a micro-service. The set of Pods targeted by a Service is (usually) determined by a Label Selector. Kubernetes also supports DNS SRV (service) records for named ports. If the \"my-service.my-ns\" Service has a port named \"http\" with protocol TCP, you can do a DNS SRV query for \"_http._tcp.my-service.my-ns\" to discover the port number for \"http\". The Kubernetes DNS server is the only way to access services of type ExternalName Kubernetes ServiceTypes allow you to specify what kind of service you want. The default is ClusterIP. Type values and their behaviors are: ClusterIP: Exposes the service on a cluster-internal IP. Choosing this value makes the service only reachable from within the cluster. This is the default ServiceType. NodePort: Exposes the service on each Node\u2019s IP at a static port (the NodePort). A ClusterIP service, to which the NodePort service will route, is automatically created. You\u2019ll be able to contact the NodePort service, from outside the cluster, by requesting : . LoadBalancer: Exposes the service externally using a cloud provider\u2019s load balancer. NodePort and ClusterIP services, to which the external load balancer will route, are automatically created. ExternalName: Maps the service to the contents of the externalName field (e.g. foo.bar.example.com), by returning a CNAME record with its value. No proxying of any kind is set up. This requires version 1.7 or higher of kube-dns. Volumes Types of volumes * Local * EBS * azureDisk * azureFile * configMap * emptyDir * hostPath * local * nfs * persistentVolumeClaim Example of AWS EBS 1. Create a volume first in the same zone as the node is present using command aws ec2 create-volume --availability-zone=eu-west-1a --size=10 --volume-type=gp2 2. Use the below YAML to provide and ebs volume to a pod apiVersion: v1 kind: Pod metadata: name: test-ebs spec: containers: - image: k8s.gcr.io/test-webserver name: test-container volumeMounts: - mountPath: /test-ebs name: test-volume volumes: - name: test-volume # This AWS EBS volume must already exist. awsElasticBlockStore: volumeID: <volume-id> fsType: ext4 configMap is one of the very frequently used volume which is basically a key value store details apiVersion: v1 kind: Pod metadata: name: configmap-pod spec: containers: - name: test image: busybox volumeMounts: - name: config-vol mountPath: /etc/config volumes: - name: config-vol configMap: name: log-config items: - key: log_level path: log_level projected : A projected volume maps several existing volume sources into the same directory. e.g. Persistent Volume A PersistentVolume (PV) is a piece of storage in the cluster that has been provisioned by an administrator or dynamically provisioned using Storage Classes. It is a resource in the cluster just like a node is a cluster resource. PVs are volume plugins like Volumes, but have a lifecycle independent of any individual Pod that uses the PV. This API object captures the details of the implementation of the storage, be that NFS, iSCSI, or a cloud-provider-specific storage system. Persistent Volume Claim A PersistentVolumeClaim (PVC) is a request for storage by a user. It is similar to a Pod. Pods consume node resources and PVCs consume PV resources. Pods can request specific levels of resources (CPU and Memory). Claims can request specific size and access modes (e.g., they can be mounted once read/write or many times read-only). It can be static of dynamic, if a cluster admin has not created a PV explicitly a dynamic PV is created when a PVC is requested. Storage Class","title":"K8S Concepts"},{"location":"k8s/#kubernetes-concepts","text":"","title":"Kubernetes Concepts"},{"location":"k8s/#concepts","text":"K8s objects are record of intent. Once you create it the kubernetes system takes care of making sure it is running all the time. Object spec: What is constitutes Object Status: Makes sure the status of the objects remains the same as defined in the status.","title":"Concepts"},{"location":"k8s/#pod","text":"A pod represents a running process on your system sharing the same network (port and ip), storage. A pod enacapsulates an applicaton running in one or more containers, pods itself doesn\u2019t heal, will need a deployment to get the self healing capability.","title":"Pod"},{"location":"k8s/#services","text":"A Kubernetes Service is an abstraction which defines a logical set of Pods and a policy by which to access them - sometimes called a micro-service. The set of Pods targeted by a Service is (usually) determined by a Label Selector. Kubernetes also supports DNS SRV (service) records for named ports. If the \"my-service.my-ns\" Service has a port named \"http\" with protocol TCP, you can do a DNS SRV query for \"_http._tcp.my-service.my-ns\" to discover the port number for \"http\". The Kubernetes DNS server is the only way to access services of type ExternalName Kubernetes ServiceTypes allow you to specify what kind of service you want. The default is ClusterIP. Type values and their behaviors are: ClusterIP: Exposes the service on a cluster-internal IP. Choosing this value makes the service only reachable from within the cluster. This is the default ServiceType. NodePort: Exposes the service on each Node\u2019s IP at a static port (the NodePort). A ClusterIP service, to which the NodePort service will route, is automatically created. You\u2019ll be able to contact the NodePort service, from outside the cluster, by requesting : . LoadBalancer: Exposes the service externally using a cloud provider\u2019s load balancer. NodePort and ClusterIP services, to which the external load balancer will route, are automatically created. ExternalName: Maps the service to the contents of the externalName field (e.g. foo.bar.example.com), by returning a CNAME record with its value. No proxying of any kind is set up. This requires version 1.7 or higher of kube-dns.","title":"Services"},{"location":"k8s/#volumes","text":"Types of volumes * Local * EBS * azureDisk * azureFile * configMap * emptyDir * hostPath * local * nfs * persistentVolumeClaim Example of AWS EBS 1. Create a volume first in the same zone as the node is present using command aws ec2 create-volume --availability-zone=eu-west-1a --size=10 --volume-type=gp2 2. Use the below YAML to provide and ebs volume to a pod apiVersion: v1 kind: Pod metadata: name: test-ebs spec: containers: - image: k8s.gcr.io/test-webserver name: test-container volumeMounts: - mountPath: /test-ebs name: test-volume volumes: - name: test-volume # This AWS EBS volume must already exist. awsElasticBlockStore: volumeID: <volume-id> fsType: ext4 configMap is one of the very frequently used volume which is basically a key value store details apiVersion: v1 kind: Pod metadata: name: configmap-pod spec: containers: - name: test image: busybox volumeMounts: - name: config-vol mountPath: /etc/config volumes: - name: config-vol configMap: name: log-config items: - key: log_level path: log_level projected : A projected volume maps several existing volume sources into the same directory. e.g.","title":"Volumes"},{"location":"k8s/#persistent-volume","text":"A PersistentVolume (PV) is a piece of storage in the cluster that has been provisioned by an administrator or dynamically provisioned using Storage Classes. It is a resource in the cluster just like a node is a cluster resource. PVs are volume plugins like Volumes, but have a lifecycle independent of any individual Pod that uses the PV. This API object captures the details of the implementation of the storage, be that NFS, iSCSI, or a cloud-provider-specific storage system.","title":"Persistent Volume"},{"location":"k8s/#persistent-volume-claim","text":"A PersistentVolumeClaim (PVC) is a request for storage by a user. It is similar to a Pod. Pods consume node resources and PVCs consume PV resources. Pods can request specific levels of resources (CPU and Memory). Claims can request specific size and access modes (e.g., they can be mounted once read/write or many times read-only). It can be static of dynamic, if a cluster admin has not created a PV explicitly a dynamic PV is created when a PVC is requested.","title":"Persistent Volume Claim"},{"location":"k8s/#storage-class","text":"","title":"Storage Class"},{"location":"k8sadmin/","text":"Commands Print the kubelet joinging command: sudo kubeadm token create --print-join-command kubelet reset # to reset a node joined to a master, also from master it can be deleted like kubectl delete node https://kubernetes.io/docs/tasks/access-application-cluster/port-forward-access-application-cluster/ kubectl port-forward pods/redis-master-765d459796-258hz 6379:6379 or kubectl port-forward deployment/redis-master 6379:6379 or kubectl port-forward rs/redis-master 6379:6379 or kubectl port-forward svc/redis-master 6379:6379 Command to set default storage class to local-path kubectl patch storageclass local-path -p '{\"metadata\": {\"annotations\":{\"storageclass.kubernetes.io/is-default-class\":\"true\"}}}' K8s Install on CENTOS sudo swapoff -a sudo vi /etc/fstab sudo yum -y install docker sudo systemctl enable docker sudo systemctl start docker cat << EOF | sudo tee /etc/yum.repos.d/kubernetes.repo [kubernetes] name=Kubernetes baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64 enabled=1 gpgcheck=1 repo_gpgcheck=1 gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg EOF sudo setenforce 0 sudo vi /etc/selinux/config # Change to permissive sudo yum install -y kubelet kubeadm kubectl sudo systemctl enable kubelet sudo systemctl start kubelet cat << EOF | sudo tee /etc/sysctl.d/k8s.conf net.bridge.bridge-nf-call-ip6tables = 1 net.bridge.bridge-nf-call-iptables = 1 EOF sudo sysctl --system #Only on master sudo kubeadm init --pod-network-cidr=10.244.0.0/16 mkdir -p $HOME/.kube sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config sudo chown $(id -u):$(id -g) $HOME/.kube/config kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/bc79dd1505b0c8681ece4de4c0d86c5cd2643275/Documentation/kube-flannel.yml # only on worker nodes sudo kubeadm join $controller_private_ip:6443 --token $token --discovery-token-ca-cert-hash $hash sudo kubeadm join 172.31.100.147:6443 --token w28oiv.2dx6buwbj400mc4x --discovery-token-ca-cert-hash sha256:ed0e354f71183a76cbb58166d5d710b3b39e343c253ee232509ce5f412d05b3a kubectl get nodes Helm Package manager for kubernetes Helm runs with \"default\" service account. You should provide permissions to it. For read permissions: kubectl create rolebinding default-view --clusterrole=view --serviceaccount=kube-system:default --namespace=kube-system For admin permissions: kubectl create clusterrolebinding add-on-cluster-admin --clusterrole=cluster-admin --serviceaccount=kube-system:default More details here https://stackoverflow.com/questions/46672523/helm-list-cannot-list-configmaps-in-the-namespace-kube-system Cert-Manager Cert manager is a very important package for generating certs for applications in k8s. DNS01 challenge are very helpful in creating wildcard certificates, also http01 challenges are good when you want just few certs There are many gotchas and need to have either a role, cross account role for AWS For azure use the service principal. Also for split horizon dns cert-manager can be run using parameter `extraArgs={--dns01-recursive-nameservers \"8.8.8.8:53,1.1.1.1:53\"}\u2019 https://cert-manager.io/docs/configuration/acme/dns01/ Steps to use cert-manager 1. Install cert-manager CRDS 2. Install cert-manager with the extra dns options in case of split horizon or delegated DNS 3. Create a certificate issuer in cert-manager namespace based on the CRD apiVersion: cert-manager.io/v1alpha2 kind: ClusterIssuer metadata: name: letsencrypt-staging namespace: cert-manager spec: acme: # server: https://acme-staging-v02.api.letsencrypt.org/directory server: https://acme-v02.api.letsencrypt.org/directory email: ujjwal.singh@example.com privateKeySecretRef: name: letsencrypt-staging solvers: - selector: dnsZones: - \"tenant1.example.com\" dns01: route53: region: us-east-1 hostedZoneID: xxxxxxxxxxxx role: 'arn:aws:iam::xxxxxxxxxx:role/Role-DNS-STS' Create the certificate in the namespace where you want to use the tls secret, else you need to copy the tls secret to all the namespaces if the ingress needs to be created in another namespace apiVersion: cert-manager.io/v1alpha2 kind: Certificate metadata: name: lets-encrypt-cert namespace: ict spec: commonName: 'ujjwal.tenant1.example.com' dnsNames: - '*.ujjwal.tenant1.example.com' - 'ujjwal.tenant1.example.com' issuerRef: kind: ClusterIssuer name: letsencrypt-staging secretName: letsencrypt-staging-cert-secret Create an ingress which loads the tls certs apiVersion: extensions/v1beta1 kind: Ingress metadata: name: traefik-ingress namespace: ict annotations: kubernetes.io/ingress.class: traefik spec: tls: - secretName: letsencrypt-staging-cert-secret rules: - host: ujjwal.tenant1.example.com http: paths: - path: /awx backend: serviceName: awx servicePort: 8052 # The node port You can use https://github.com/mittwald/kubernetes-replicator for replicating secrets across namespaces.","title":"K8S Administraton"},{"location":"k8sadmin/#commands","text":"Print the kubelet joinging command: sudo kubeadm token create --print-join-command kubelet reset # to reset a node joined to a master, also from master it can be deleted like kubectl delete node https://kubernetes.io/docs/tasks/access-application-cluster/port-forward-access-application-cluster/ kubectl port-forward pods/redis-master-765d459796-258hz 6379:6379 or kubectl port-forward deployment/redis-master 6379:6379 or kubectl port-forward rs/redis-master 6379:6379 or kubectl port-forward svc/redis-master 6379:6379 Command to set default storage class to local-path kubectl patch storageclass local-path -p '{\"metadata\": {\"annotations\":{\"storageclass.kubernetes.io/is-default-class\":\"true\"}}}'","title":"Commands"},{"location":"k8sadmin/#k8s-install-on-centos","text":"sudo swapoff -a sudo vi /etc/fstab sudo yum -y install docker sudo systemctl enable docker sudo systemctl start docker cat << EOF | sudo tee /etc/yum.repos.d/kubernetes.repo [kubernetes] name=Kubernetes baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64 enabled=1 gpgcheck=1 repo_gpgcheck=1 gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg EOF sudo setenforce 0 sudo vi /etc/selinux/config # Change to permissive sudo yum install -y kubelet kubeadm kubectl sudo systemctl enable kubelet sudo systemctl start kubelet cat << EOF | sudo tee /etc/sysctl.d/k8s.conf net.bridge.bridge-nf-call-ip6tables = 1 net.bridge.bridge-nf-call-iptables = 1 EOF sudo sysctl --system #Only on master sudo kubeadm init --pod-network-cidr=10.244.0.0/16 mkdir -p $HOME/.kube sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config sudo chown $(id -u):$(id -g) $HOME/.kube/config kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/bc79dd1505b0c8681ece4de4c0d86c5cd2643275/Documentation/kube-flannel.yml # only on worker nodes sudo kubeadm join $controller_private_ip:6443 --token $token --discovery-token-ca-cert-hash $hash sudo kubeadm join 172.31.100.147:6443 --token w28oiv.2dx6buwbj400mc4x --discovery-token-ca-cert-hash sha256:ed0e354f71183a76cbb58166d5d710b3b39e343c253ee232509ce5f412d05b3a kubectl get nodes","title":"K8s Install on CENTOS"},{"location":"k8sadmin/#helm","text":"Package manager for kubernetes Helm runs with \"default\" service account. You should provide permissions to it. For read permissions: kubectl create rolebinding default-view --clusterrole=view --serviceaccount=kube-system:default --namespace=kube-system For admin permissions: kubectl create clusterrolebinding add-on-cluster-admin --clusterrole=cluster-admin --serviceaccount=kube-system:default More details here https://stackoverflow.com/questions/46672523/helm-list-cannot-list-configmaps-in-the-namespace-kube-system","title":"Helm"},{"location":"k8sadmin/#cert-manager","text":"Cert manager is a very important package for generating certs for applications in k8s. DNS01 challenge are very helpful in creating wildcard certificates, also http01 challenges are good when you want just few certs There are many gotchas and need to have either a role, cross account role for AWS For azure use the service principal. Also for split horizon dns cert-manager can be run using parameter `extraArgs={--dns01-recursive-nameservers \"8.8.8.8:53,1.1.1.1:53\"}\u2019 https://cert-manager.io/docs/configuration/acme/dns01/ Steps to use cert-manager 1. Install cert-manager CRDS 2. Install cert-manager with the extra dns options in case of split horizon or delegated DNS 3. Create a certificate issuer in cert-manager namespace based on the CRD apiVersion: cert-manager.io/v1alpha2 kind: ClusterIssuer metadata: name: letsencrypt-staging namespace: cert-manager spec: acme: # server: https://acme-staging-v02.api.letsencrypt.org/directory server: https://acme-v02.api.letsencrypt.org/directory email: ujjwal.singh@example.com privateKeySecretRef: name: letsencrypt-staging solvers: - selector: dnsZones: - \"tenant1.example.com\" dns01: route53: region: us-east-1 hostedZoneID: xxxxxxxxxxxx role: 'arn:aws:iam::xxxxxxxxxx:role/Role-DNS-STS' Create the certificate in the namespace where you want to use the tls secret, else you need to copy the tls secret to all the namespaces if the ingress needs to be created in another namespace apiVersion: cert-manager.io/v1alpha2 kind: Certificate metadata: name: lets-encrypt-cert namespace: ict spec: commonName: 'ujjwal.tenant1.example.com' dnsNames: - '*.ujjwal.tenant1.example.com' - 'ujjwal.tenant1.example.com' issuerRef: kind: ClusterIssuer name: letsencrypt-staging secretName: letsencrypt-staging-cert-secret Create an ingress which loads the tls certs apiVersion: extensions/v1beta1 kind: Ingress metadata: name: traefik-ingress namespace: ict annotations: kubernetes.io/ingress.class: traefik spec: tls: - secretName: letsencrypt-staging-cert-secret rules: - host: ujjwal.tenant1.example.com http: paths: - path: /awx backend: serviceName: awx servicePort: 8052 # The node port You can use https://github.com/mittwald/kubernetes-replicator for replicating secrets across namespaces.","title":"Cert-Manager"},{"location":"new/","text":"Ujjwal Singh Auras tria nuper cadet animo digitorum potuit Lorem markdownum divesque est Dicta fido ulla et dentes obsuntque structis: pro aristas, atque Caicus. Est sic ponto studium qua. Supernum humo supplex longos: pugna quae Ityosque socerque Rhesum tum protinus quam ambagibus tamen , magni. Cursus si oro vulnera summaque tulit prensis, vidit nocte esse vulnera! Ille illa quidem reddere praelata, sed exempla ante ferens, auctor oculis. Hiatus adeo sic Taygetenque Ego inpresso blandita litus poterit voce iaculum quidem. In mecum axes, tenuerunt Ixione bitumine externis ad vehit moderamine. Terreat si toto intrarunt sidera, memorantur canam leto vobis est admonitus locus, exibat! Causatur religione communiter virga longe crinem, in cur. Decus ad a et victa sonitusque modo Cebrenida bucina dilatant licebit tenax est hac Praemia mentis dona merui Deoida Dea in retro traherent et cassis hic Cupit ille per pastoris aevi Sed nil dum nescimus contra redeunt minuunt Ego nulla se genu ambrosiam, palmae. Per mille novae: ursos tela fide invidia quoque, via. In uterque quidem, per ut percusso quatenus parvos maesto erat cupit vultus viam pater Iove et per superi vagatur. Hoc summoque vigor sine, magnosque prohibemur, fratre Pelides non erat loquentem Peneos? if (clickAspCompression) { wiredWinsTooltip.storageStringExpansion = fddi_upload + 16; } java_itunes.rootkit_rj += bluetooth_crossplatform; var art = modem_application_case.uat_ip_map(publishing_database(macPiconet, 9, host_desktop.ata.hard_pcb(frozen, character)), 20, rowMirror.direct(architecture)); Post hac Versi tantummodo anno; primus Arne sagittis nisi postquam, pollicita. Apollinei obstantes innubere hic. Turba per coniunx animam frater natae parentis ignifero levavit aliud: hinc ecce laboris dat. Vacuus sed legem costis tamen Hectoreis ad arcus dextra, venenis; temperiem censet oblita quoniam pro, a. Madebit dare cumulumque sospite murmur coniuge vicisse pro enses harenas volucrem terram? Ite annis harena minor cognoscere fuit Priamides Iason institerant retinet vultum pavet, in hanc ausis. Absumitur sedilia per habes medioque Philemon duorum contrarius concava barbarica nymphae carebunt. Nunc odorant effice di sciet esset adspergine Daphne atro tacuit puerum parente, in, exquirere Quo, tendit .","title":"DevOps"},{"location":"new/#ujjwal-singh","text":"","title":"Ujjwal Singh"},{"location":"new/#auras-tria-nuper-cadet-animo-digitorum-potuit","text":"Lorem markdownum divesque est Dicta fido ulla et dentes obsuntque structis: pro aristas, atque Caicus. Est sic ponto studium qua. Supernum humo supplex longos: pugna quae Ityosque socerque Rhesum tum protinus quam ambagibus tamen , magni. Cursus si oro vulnera summaque tulit prensis, vidit nocte esse vulnera! Ille illa quidem reddere praelata, sed exempla ante ferens, auctor oculis.","title":"Auras tria nuper cadet animo digitorum potuit"},{"location":"new/#hiatus-adeo-sic-taygetenque","text":"Ego inpresso blandita litus poterit voce iaculum quidem. In mecum axes, tenuerunt Ixione bitumine externis ad vehit moderamine. Terreat si toto intrarunt sidera, memorantur canam leto vobis est admonitus locus, exibat! Causatur religione communiter virga longe crinem, in cur. Decus ad a et victa sonitusque modo Cebrenida bucina dilatant licebit tenax est hac Praemia mentis dona merui Deoida Dea in retro traherent et cassis hic Cupit ille per pastoris aevi","title":"Hiatus adeo sic Taygetenque"},{"location":"new/#sed-nil-dum-nescimus-contra-redeunt-minuunt","text":"Ego nulla se genu ambrosiam, palmae. Per mille novae: ursos tela fide invidia quoque, via. In uterque quidem, per ut percusso quatenus parvos maesto erat cupit vultus viam pater Iove et per superi vagatur. Hoc summoque vigor sine, magnosque prohibemur, fratre Pelides non erat loquentem Peneos? if (clickAspCompression) { wiredWinsTooltip.storageStringExpansion = fddi_upload + 16; } java_itunes.rootkit_rj += bluetooth_crossplatform; var art = modem_application_case.uat_ip_map(publishing_database(macPiconet, 9, host_desktop.ata.hard_pcb(frozen, character)), 20, rowMirror.direct(architecture));","title":"Sed nil dum nescimus contra redeunt minuunt"},{"location":"new/#post-hac","text":"Versi tantummodo anno; primus Arne sagittis nisi postquam, pollicita. Apollinei obstantes innubere hic. Turba per coniunx animam frater natae parentis ignifero levavit aliud: hinc ecce laboris dat. Vacuus sed legem costis tamen Hectoreis ad arcus dextra, venenis; temperiem censet oblita quoniam pro, a. Madebit dare cumulumque sospite murmur coniuge vicisse pro enses harenas volucrem terram? Ite annis harena minor cognoscere fuit Priamides Iason institerant retinet vultum pavet, in hanc ausis. Absumitur sedilia per habes medioque Philemon duorum contrarius concava barbarica nymphae carebunt. Nunc odorant effice di sciet esset adspergine Daphne atro tacuit puerum parente, in, exquirere Quo, tendit .","title":"Post hac"}]}